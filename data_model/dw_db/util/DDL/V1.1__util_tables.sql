USE SCHEMA UTIL;

CREATE OR REPLACE FILE FORMAT FF_XML
	TYPE = XML
    COMMENT = 'Usage: EDI 837 XML files'
;


CREATE OR REPLACE FILE FORMAT FF_COLON_CSV
	TYPE = CSV
    FIELD_DELIMITER = ':'
    COMMENT = 'Usage: EDI 837 CTL files'
;

CREATE OR REPLACE FILE FORMAT FF_SOH_CSV TYPE = 'csv' FIELD_DELIMITER = '' NULL_IF = ('NULL','null')
	    COMMENT = 'Usage: EDI Legacy Data Load'
;


create TABLE IF NOT EXISTS PROCESS_LIST (
	APP_NAME VARCHAR(100),
	PROCESS_NAME VARCHAR(100),
	DATA_FACTORY_NAME VARCHAR(100),
	ACTIVE_INDC VARCHAR(1),
	ISDC_CREATED_DT TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP(),
	ISDC_UPDATED_DT TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP()
);


create TABLE IF NOT EXISTS PROCESS_RUN_LOGS (
	
	PIPELINE_ID VARCHAR(16777216),
	PIPELINE_NAME VARCHAR(16777216),
	APP_NAME VARCHAR(16777216),
	PROCESS_NAME VARCHAR(50) NOT NULL,
	SUB_PROCESS_NAME VARCHAR(100),
	START_DATETIME TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP(),
	END_DATETIME TIMESTAMP_NTZ(9),
	MESSAGE VARCHAR(16777216),
	DURATION VARCHAR(100),
	STATUS VARCHAR(100),
	DATAFACTORY VARCHAR(16777216),
	TRIGGER_NAME VARCHAR(16777216),
	TRIGGER_TYPE VARCHAR(16777216),
	TRIGGER_TIME TIMESTAMP_NTZ(9),
	ISDC_LOAD_DT TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP()
);
create TABLE IF NOT EXISTS PROCESS_RUN_LOGS_DTL (
        PIPELINE_ID VARCHAR(16777216),
	PIPELINE_NAME VARCHAR(16777216),
	APP_NAME VARCHAR(16777216),
	PROCESS_NAME VARCHAR(16777216),
	SUB_PROCESS_NAME VARCHAR(16777216),
	STEP VARCHAR(16777216),
	STEP_NAME VARCHAR(16777216),
	START_DATETIME TIMESTAMP_NTZ(9),
	END_DATETIME TIMESTAMP_NTZ(9),
	STATUS VARCHAR(16777216),
	LAST_QUERY_ID VARCHAR(16777216),
	ROWS_PARSED VARCHAR(16777216),
	ROWS_LOADED VARCHAR(16777216),
	MESSAGE VARCHAR(16777216),
	ERROR_CODE VARCHAR(16777216),
	ERROR_STATE VARCHAR(16777216),
	ISDC_LOAD_DT TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP()
);

create TABLE IF NOT EXISTS PROGRAM_LIST (
	APP_NAME VARCHAR(100),
	PROCESS_NAME VARCHAR(100),
	SUB_PROCESS_NAME VARCHAR(100),
	DATA_FACTORY_NAME VARCHAR(100),
	OBJECT_DB VARCHAR(100),
	OBJECT_SCHEMA VARCHAR(100),
	OBJECT_NAME VARCHAR(100),
	OBJECT_SIGNATURE VARCHAR(500),
	LAST_SUCCESSFUL_LOAD VARCHAR(100),
	ISDC_CREATED_DT TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP(),
	ISDC_UPDATED_DT TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP()
);
create TABLE IF NOT EXISTS TRIGGERS_LIST (
	APP_NAME VARCHAR(16777216),
	SUBSCRIPTION_ID VARCHAR(16777216),
	RESOURCE_GROUP VARCHAR(16777216),
	DATA_FACTORY_NAME VARCHAR(16777216),
	TRIGGER_NAME VARCHAR(16777216),
	TRIGGER_TYPE VARCHAR(16777216),
	ACTIVE_INDC VARCHAR(16777216),
	API_VERSION VARCHAR(16777216),
	COMMENTS VARCHAR(16777216),
	ISDC_CREATED_DT TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP(),
	ISDC_UPDATED_DT TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP()
);

